---
title: コンストラクタ
sidebar_position: 3
---

:::warning
校正作業中。
:::

## インスタンス生成時に初期化処理を行う

その場合には、**コンストラクタ** と呼ばれるクラスのインスタンス化時初期化を行う特殊メソッドを定義します。

フィールドの隠ぺいにより、インスタンス生成後にフィールドへアクセスできず値の設定が行えないなどの制約に対応できます。

### コンストラクタとは
**戻り値のない**、**クラス名と同じ名前のメソッド** として定義され、クラスがインスタンス化された際に初期化する処理などを担うメソッドです。

### コンストラクタの書式
MyClassという名前のクラスにコンストラクタを定義するには、以下のようにします。

```java
public class MyClass {

    public MyClass() {
        //ここにMyClassのフィールドを初期化する処理などを書きます。
    }
}
```

`public MyClass()`とした部分が、コンストラクタです。



### コンストラクタはどこで呼ばれるか
クラスに定義されたコンストラクタは、new演算子によりインスタンス化されたタイミングで呼ばれます。

上記MyClassを使用する他のクラスにて

```java
MyClass mc = new MyClass();
```

としたときに呼び出されます。


### コンストラクタには引数も付けられる

コンストラクタには、引数を設定できます。

```java
public class MyClass {

    public MyClass() {
        //ここにMyClassのフィールドを初期化する処理などを書きます。
        //引数が渡されなかった時のみ実行される。
    }
    public MyClass(int val) {
        //MyClassがインスタンス化された際に、int型の引数が渡された時のみ実行される
    }
    public MyClass(int val1, double val2) {
        //MyClassがインスタンス化された際に、int型とdouble型の引数が2つ渡された時のみ実行される
    }
}
```

上記例のように、引数が付けられられるということは、オーバーロードも可能です。
初期化のタイミングで、型に合わせた処理をさせたい場合は、オーバーロードしましょう。

#### 自分のコンストラクタを自分のクラス内から呼び出すことも可能

その場合は、`this()`を使用します。

使い方としては以下の様なパターンが考えられます。

```java
public class MyClass {
    int field;

    public MyClass() {
        //引数が設定されなかった場合は初期値を設定するために引数付きのコンストラクタを呼び出す
        this(1);
    }
    public MyClass(int val) {
        this.field = val;
    }
}
```

逆に、引数無しのコンストラクタにクラスの共通的な初期化処理を書き、引数ありのコンストラクタから`this()`で引数なしコンストラクタを呼び出すことで処理を共通化させる、ということも可能です。


### コンストラクタにもアクセス制限を設けることができる
上記例では、どこからでもアクセスできるように`public`を指定しています。

「引数無しのコンストラクタだけは外部からアクセスされたくない」と言う場合は以下のようにすることで、外部からnew演算子でインスタンス化する際に引数無しでは呼び出せなくなります。

```java
public class MyClass {
    int field;

    private MyClass() {
        //外部からは呼び出せない
    }
    public MyClass(int val) {

    }
}
```

呼び出す側では、以下のように、引数なしの場合にコンパイルエラーが出るようになります。

```java
MyClass mc = new MyClass();    //コンパイルエラーとなる
MyClass mc = new MyClass( 1 ); //こっちはOK
```

#### コンストラクタにアクセス制限を付ける場合の注意点
すべてのコンストラクタを`private`などにしてしまうと、そのクラスはインスタンス化出来なくなり、使うことすらできません。
どれか1つは`public`か`指定なし`にしておきましょう。

## まとめ
クラスのフィールドを初期化する処理などは、コンストラクタで書いておくと、インスタンス化後に値を個別に指定することなく使用できます。
